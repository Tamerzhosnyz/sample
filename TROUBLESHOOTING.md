# WMS Application Troubleshooting Guide

## Common Startup Issues and Solutions

### Issue: "Error loading application"

**Symptoms:**
- Browser shows "Error loading application" message
- Application fails to load properly
- Blank page or loading errors

**Root Causes:**
1. Frontend not built (missing `dist` directory)
2. Backend server not running
3. Missing dependencies
4. Port conflicts
5. Database connection issues

**Solutions:**

#### Quick Fix (Automated)
```bash
# Run the automated fix script
node scripts/fix-startup.js

# Or manually run the fix commands
npm run build && npm run server
```

#### Manual Diagnosis and Fix

1. **Check if frontend is built:**
   ```bash
   ls dist/
   # Should contain index.html and assets folder
   ```

2. **Build frontend if missing:**
   ```bash
   npm run build
   ```

3. **Check if dependencies are installed:**
   ```bash
   ls node_modules/
   # Should contain many package folders
   ```

4. **Install dependencies if missing:**
   ```bash
   npm install
   ```

5. **Start the server:**
   ```bash
   npm run server
   ```

6. **Check if port 3000 is available:**
   ```bash
   # On Windows
   netstat -ano | findstr :3000
   
   # On Linux/Mac
   lsof -i :3000
   ```

### Issue: Database Connection Errors

**Symptoms:**
- Server starts but API calls fail
- "Database not initialized" errors
- Migration errors

**Solutions:**

1. **Check database file exists:**
   ```bash
   ls backend/data/
   # Should contain wms.db
   ```

2. **Restart server to reinitialize database:**
   ```bash
   npm run server
   ```

3. **Check database permissions:**
   ```bash
   # Ensure backend/data directory is writable
   chmod 755 backend/data/
   ```

### Issue: Port Already in Use

**Symptoms:**
- "EADDRINUSE" error
- "Port 3000 is already in use"

**Solutions:**

1. **Find and kill process using port 3000:**
   ```bash
   # On Windows
   netstat -ano | findstr :3000
   taskkill /PID <PID> /F
   
   # On Linux/Mac
   lsof -ti:3000 | xargs kill -9
   ```

2. **Or use a different port (not recommended):**
   ```bash
   # Modify package.json scripts to use different port
   # Note: Application is configured to only work on port 3000
   ```

### Issue: Module Not Found Errors

**Symptoms:**
- "Cannot find module" errors
- Import/require errors

**Solutions:**

1. **Clear node_modules and reinstall:**
   ```bash
   rm -rf node_modules package-lock.json
   npm install
   ```

2. **Check for missing dependencies:**
   ```bash
   npm audit
   npm install --save <missing-package>
   ```

### Issue: Build Failures

**Symptoms:**
- "npm run build" fails
- TypeScript compilation errors
- Asset bundling errors

**Solutions:**

1. **Clear build cache:**
   ```bash
   rm -rf dist
   npm run build
   ```

2. **Check for TypeScript errors:**
   ```bash
   npx tsc --noEmit
   ```

3. **Update dependencies:**
   ```bash
   npm update
   ```

## Prevention Tips

1. **Always build before deploying:**
   ```bash
   npm run build
   ```

2. **Use the correct startup command:**
   ```bash
   npm run server  # Not npm run dev
   ```

3. **Ensure port 3000 is available:**
   - The application is hardcoded to use port 3000
   - Don't run multiple instances simultaneously

4. **Regular maintenance:**
   ```bash
   # Weekly cleanup
   npm audit fix
   npm run build
   ```

## Emergency Recovery

If all else fails, try this complete reset:

```bash
# 1. Stop all Node processes
pkill -f node

# 2. Clean everything
rm -rf node_modules package-lock.json dist

# 3. Reinstall and rebuild
npm install
npm run build

# 4. Start fresh
npm run server
```

## Getting Help

If issues persist:

1. Check the server console for detailed error messages
2. Check browser developer console for frontend errors
3. Verify all files are present in the project directory
4. Ensure you have the correct Node.js version (16+ recommended)

## File Structure Verification

Your project should have this structure:
```
├── backend/
│   ├── server.js
│   ├── database/
│   └── routes/
├── src/
│   ├── App.tsx
│   ├── main.tsx
│   └── components/
├── dist/           # Generated by build
│   ├── index.html
│   └── assets/
├── package.json
└── node_modules/   # Generated by npm install
```

If any of these are missing, the application may not start properly.